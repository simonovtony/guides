<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
</head>
<body>
<script>
    /**************************************
     * Компактное представление объектов
     **************************************/

    /**
     * Hardcore coders only
     * Эта секция относится ко внутреннему устройству структуры данных. Она не обязательна к прочтению.
     */

    /**
     * Браузер использует специальное «компактное» представление объектов, чтобы сэкономить
     * память в том случае, когда однотипных объектов много.
     * Например, посмотрим на такой объект:
     */
    var user = {
        name: "Vasya",
        age: 25
    };

    /**
     * Здесь содержится информация о свойстве name и его строковом значении,
     * а также о свойстве age и его численном значении. Представим, что таких объектов много.
     * Получится, что информация об именах свойств name и age дублируется в каждом объекте.
     * Чтобы этого избежать, браузер применяет оптимизацию.
     * При создании множества объектов одного и того же вида (с одинаковыми полями) интерпретатор
     * выносит описание полей в отдельную структуру. А сам объект остаётся в виде непрерывной области памяти с данными.
     * Например, есть много объектов с полями name и age:
     */
//    {name: "Вася", age: 25}
//    {name: "Петя", age: 22}
//    {name: "Маша", age: 19}
//    ...

    /**
     * Для их эффективного хранения будет создана структура, которая описывает данный вид объектов.
     * Выглядеть она будет примерно так: <string name, number age>.
     * А сами объекты будут представлены в памяти только данными:
     */
//    <структура: string name, number age>
//    Вася 25
//    Петя 22
//    Маша 19

    /**
     * При добавлении нового объекта такой структуры достаточно хранить
     * значения полей, но не их имена. Экономия памяти – налицо.
     * А что происходит, если к объекту добавляется новое свойство?
     * Например, к одному из них добавили свойство isAdmin:
     */
    user.isAdmin = true;

    /**
     * В этом случае браузер смотрит, есть ли уже структура, под которую подходит такой объект. Если нет –
     * она создаётся и объект привязывается к ней.
     * Эта оптимизация является примером того, что далеко не всё то, что мы пишем, один-в-один переносится в память.
     * Современные интерпретаторы очень стараются оптимизировать как код, так и структуры данных.
     * Детали применения и реализации этого способа хранения варьируются от браузера к браузеру. О том,
     * как это сделано в Chrome можно узнать, например, из презентации Know Your Engines. Она была
     * некоторое время назад, но с тех пор мало что изменилось.
     */
</script>
</body>
</html>